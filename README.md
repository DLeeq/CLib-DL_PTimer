# DL_PTimer
**Простая библиотека для гибкого и удобного создания и управления программными таймерами с минимальным интервалом 1 мс. Основана на C и HAL.**
## Оглавление
1. [Описание](#описание)
2. [Установка](#установка)
3. [Использование](#использование)
4. [Совместимость](#совместимость)
5. [Версии](#версии)
6. [Обратная связь](#обратная-связь)
## Описание  
Библиотека предлагает простой и понятный интерфейс для создания и обработки программных таймеров с минимальным интервалом 1мс.
- Количество создаваемых таймеров не ограничено
- Задание интервалов времени в:
  - Миллисекундах
  - Секундах
  - Минутах
  - Часах
  - Днях 
- Максимальный временной интервал ограничен 32-битной переменной счетчика. ~49.7 дней.
- Интерфейс:
  - Запуск таймера (В разных единицах времени)
  - Остановка таймера
  - Пауза таймера
  - Возобновление таймера
  - Принудительное истекание таймера
  - Проверка состояния таймера

Библиотека снабжена подробными комментариями.

## Установка
**Установка в директорию с пользовательскими библиотеками (Рекомендуется):**
 1. Скачайте и добавьте директорию **DL_PTimer** в папку с пользовательскими библиотеками вашего проекта (создайте папку, если её нет)
 2. Укажите пути в вашей IDE для директории с заголовочным файлом и файлом реализации
 3. Подключите библиотеку с помощью директивы include:
   ```c
   #include "DL_PTimer.h"  //Если указаны пути в IDE путь можно не прописывать
   ```
 4. Не забудьте заменить в файле **DL_PTimer.h** подключаемую HAL библиотеку на вашу версию МК
   ```c
   #include "stm32f1xx_hal.h"  //Замените на свою версию
   ```
**Установка в корень проекта (Проще):**
  1. Добавьте заголовочный файл **DL_PTimer/DL_PTimer.h** в директорию с вашими заголовочными файлами проекта
  2. Добавьте файл реализации **DL_PTimer/DL_PTimer.c** в директорию с вашими заголовочными файлами проекта
  3. Подключите библиотеку с помощью директивы include:
   ```c
   #include "DL_PTimer.h"  //Если библиотека установлена в корень вашего проекта
   ```
  4. Не забудьте заменить в файле **DL_PTimer.h** подключаемую HAL библиотеку на вашу версию МК
   ```c
   #include "stm32f1xx_hal.h"  //Замените на свою версию
   ```
***Важно:***
***Внимательно проверяйте пути к заголовочному файлу и файлу реализации***
## Использование

Создание экземпляра структуры таймера и запуск таймера с интервалом 50мс:
```c
DL_PTimer tim = {0};
DL_pTimStart(&tim, 50); //Параметры: Структура таймера, интервал времени
```
В основной цикл программы добавьте проверку истекания таймера следующим образом:
```c
while (1)
{
  if( DL_pTimExpired(&tim) )  //Должна вызываться как можно чаще
  {
        ... 
        //Сработает единственный раз когда таймер истечет
  }
  ...
}
```
Если нужно, чтобы таймер работал периодично, а не единожды, делайте так:
```c
while (1)
{
  if( DL_pTimExpired(&tim) )  //Должна вызываться как можно чаще
  {
        ...
        DL_pTimStart(&tim, 50);  //Повторный запуск таймера
        //Код в условии будет вызываться каждые 50мс
  }
  ...
}
```
Описание всех функций:
```c
void DL_pTimStart(DL_PTimer* ptimer, uint32_t ms);  //Функция запуска таймера, интервал в миллисекундах
void DL_pTimStartSec(DL_PTimer* ptimer, uint32_t sec, uint32_t ms);  //Функция запуска таймера, интервал в миллисекундах
void DL_pTimStartMin(DL_PTimer* ptimer, uint32_t min, uint32_t sec, uint32_t ms);  //Функция запуска таймера, интервал в минутах
void DL_pTimStartHour(DL_PTimer* ptimer, uint32_t hour, uint32_t min, uint32_t sec, uint32_t ms);  //Функция запуска таймера, интервал в часах
void DL_pTimStartDay(DL_PTimer* ptimer, uint32_t day, uint32_t hour, uint32_t min, uint32_t sec, uint32_t ms);  //Функция запуска таймера, интервал в днях  (Максимальный возможный интервал ~49.7 дней)

void DL_pTimStop(DL_PTimer* ptimer);  //Функция для остановки и сброса таймера

void DL_pTimPause(DL_PTimer* ptimer);  //Функция для остановки таймера без сброса
void DL_pTimResume(DL_PTimer* ptimer);  //Функция для запуска таймера без обновления счетчика

void DL_pTimForcedExpiration(DL_PTimer* ptimer);  //Функция принудительного истекания таймера

uint8_t DL_pTimExpired(DL_PTimer* ptimer);  //Функция проверки состояния таймера
```
## Совместимость
Библиотека написана, протестирована и гарантированно работает на отладочной плате "Blue Pill Plus" на базе МК STM32F103C8T6.
Благодаря использованию HAL, библиотека должна работать на подавляющем большинстве МК STM32.
## Версии
- v1.0

## Обратная связь
Если вы нашли баг, или есть предложения по доработке, пишите мне в [Телеграм - группу](https://t.me/DLeeFB) для обратной связи =)
